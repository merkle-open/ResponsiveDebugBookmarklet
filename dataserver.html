<!doctype html>
<!-- Original: Copyright 2010 Nicholas C. Zakas. All rights reserved. BSD Licensed. -->
<html>
<body>
<script type="text/javascript">
(function(){
    function handleRequest(event){
        var data = JSON.parse(event.data);
        if(data.value !== undefined){
            if(data.value === null){
                localStorage.removeItem(data.key);
            }else{
                localStorage.setItem(data.key, data.value);
            }
        }else{
            var value = localStorage.getItem(data.key);
            event.source.postMessage(JSON.stringify({id: data.id, key:data.key, value: value}), event.origin);
        }
    }
    if(window.addEventListener){
        window.addEventListener("message", handleRequest, false);
    } else if (window.attachEvent){
        window.attachEvent("onmessage", handleRequest);
    }
})();
</script>
</body>
</html>